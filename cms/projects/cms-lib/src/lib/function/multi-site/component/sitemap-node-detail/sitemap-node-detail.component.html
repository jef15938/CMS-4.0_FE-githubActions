<ng-container *ngIf="sitemapMaintainModel">
  <!-- <div *ngIf="siteMapUpdateInfo?.siteMap" class="page-title-container">
    <h1>{{siteMapUpdateInfo.siteMap.node_name}}</h1>
  </div> -->

  <!-- debug 用 -->
  <div
    style="padding-left: 10px; font-size:12px; height:24px; line-height:24px; vertical-align: middle; border-bottom: 1px solid lightgray;">
    <span style="color: red;">DEBUG : </span>
    NodeType={{siteMapUpdateInfo.siteMap.node_type}}, NodeID={{siteMapUpdateInfo.siteMap.node_id}},
    ParentId={{siteMapUpdateInfo.parentId}}, NodeOrder={{siteMapUpdateInfo.nodeOrder}}
  </div>

  <ng-container *ngIf="siteMapUpdateInfo?.siteMap; let sitemapNode">
    <div class="page-content-container" style="border-bottom: 1px solid lightgray;">
      <div class="btn-group">
        <button type="button" tabindex="0" mat-button>編輯節點</button>
        <button type="button" tabindex="0" mat-button [disabled]="!siteMapUpdateInfo.siteMap.canModify"
          [ngSwitch]="sitemapNode.node_type" (click)="editContent()">
          <ng-container *ngSwitchCase="SiteMapNodeType.CONTENT">
            頁面編輯
          </ng-container>
          <ng-container *ngSwitchCase="SiteMapNodeType.FARM">
            頁面管理
          </ng-container>
          <ng-container *ngSwitchDefault>
            頁面編輯
          </ng-container>
        </button>
        <button type="button" tabindex="0" mat-button [disabled]="!siteMapUpdateInfo.siteMap.canSubmit"
          (click)="auditingSiteMap()">頁面送審</button>
      </div>
    </div>
  </ng-container>

  <ng-container *ngIf="siteMapUpdateInfo.siteMap.publish_info; let publishInfo">
    <div *ngIf="publishInfo.draft || publishInfo.pending_published || publishInfo.published"
      class="page-content-container" style="color: gray; border-bottom: 1px solid lightgray;">
      <div *ngIf="siteMapUpdateInfo.siteMap.publish_info.draft; let obj">
        後台草稿上下架：{{ obj.start_time | dateStringFormat:'DATETIME' }} / {{ obj.end_time | dateStringFormat:'DATETIME' }}
      </div>
      <div *ngIf="siteMapUpdateInfo.siteMap.publish_info.pending_published; let obj">
        等待發布：{{ obj.start_time | dateStringFormat:'DATETIME' }} / {{ obj.end_time | dateStringFormat:'DATETIME' }}
      </div>
      <div *ngIf="siteMapUpdateInfo.siteMap.publish_info.published; let obj">
        線上上下架：{{ obj.start_time | dateStringFormat:'DATETIME' }} / {{ obj.end_time | dateStringFormat:'DATETIME' }}
      </div>
    </div>
  </ng-container>

  <div class="page-content-container" *ngIf="siteMapUpdateInfo?.siteMap">
    <form #form="ngForm" style="margin-top: 10px;">
      <!-- <mat-form-field appearance="outline">
        <mat-label>節點名稱</mat-label>
        <input matInput [(ngModel)]="sitemapMaintainModel.node_name" name="node_name" required #modelNodeName="ngModel">
      </mat-form-field> -->
      <mat-form-field appearance="outline" *ngIf="siteMapUpdateInfo?.siteMap">
        <mat-label>節點類型</mat-label>
        <mat-select [(ngModel)]="siteMapUpdateInfo.siteMap.node_type" name="node_type" disabled>
          <mat-option *ngFor="let option of nodeTypeOptions" [value]="option.value">
            {{option.name}}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <ng-container [ngSwitch]="siteMapUpdateInfo.siteMap?.node_type">
        <!-- URL -->
        <ng-container *ngSwitchCase="SiteMapNodeType.URL">
          <mat-form-field appearance="outline">
            <mat-label>連結類型</mat-label>
            <mat-select [(ngModel)]="sitemapMaintainModel.url_type" name="url_type" disabled>
              <mat-option *ngFor="let option of urlTypeOptions" [value]="option.value">
                {{option.name}}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <ng-container [ngSwitch]="sitemapMaintainModel.url_type">
            <!-- 站內 -->
            <ng-container *ngSwitchCase="SiteMapUrlType.INSIDE">
              <mat-form-field appearance="outline">
                <mat-label>站內節點ID</mat-label>
                <input matInput [(ngModel)]="sitemapMaintainModel.url_link_node_id" name="url_link_node_id">
              </mat-form-field>
            </ng-container>
            <!-- 站外 -->
            <ng-container *ngSwitchCase="SiteMapUrlType.OUTSIDE">
              <mat-form-field appearance="outline">
                <mat-label>站外網址</mat-label>
                <input matInput [(ngModel)]="sitemapMaintainModel.url" name="url">
              </mat-form-field>
            </ng-container>
            <!-- 共通 -->
            <mat-form-field appearance="outline">
              <mat-label>另開視窗</mat-label>
              <mat-select [(ngModel)]="sitemapMaintainModel.url_blank" name="url_blank">
                <mat-option *ngFor="let option of urlBlankTypeOptions" [value]="option.value">
                  {{option.name}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </ng-container>
        </ng-container>

        <!-- <mat-form-field appearance="outline">
          <mat-label>Meta標題</mat-label>
          <input matInput [(ngModel)]="sitemapMaintainModel.meta_title" name="meta_title" required
            #modelMetaTitle="ngModel">
        </mat-form-field> -->
        <!-- CONTENT -->
        <ng-container *ngSwitchCase="SiteMapNodeType.CONTENT">
          <mat-form-field appearance="outline">
            <mat-label>節點連結路徑</mat-label>
            <input matInput [(ngModel)]="sitemapMaintainModel.content_path" name="content_path"
              #modelMetaTitle="ngModel">
          </mat-form-field>
          <!-- <mat-form-field appearance="outline">
            <mat-label>Meta描述</mat-label>
            <input matInput [(ngModel)]="sitemapMaintainModel.meta_description" name="meta_description">
          </mat-form-field> -->
          <!-- <mat-form-field appearance="outline">
            <mat-label>Meta關鍵字</mat-label>
            <input matInput [(ngModel)]="sitemapMaintainModel.meta_keyword" name="meta_keyword">
          </mat-form-field> -->
          <!-- <mat-form-field appearance="outline">
            <mat-label>Meta圖片</mat-label>
            <input matInput [(ngModel)]="sitemapMaintainModel.meta_image" name="meta_image">
          </mat-form-field> -->
        </ng-container>
      </ng-container>
      <div class="btn-group" style="text-align: center;">
        <button type="button" tabindex="0" mat-button (click)="save()" [disabled]="form.invalid">儲存節點</button>
      </div>
    </form>
  </div>
</ng-container>
